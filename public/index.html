<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>Norwegian Kosher List</title>

    <!-- Firebase App is always required and must be first -->

    <!-- Uncomment for production, comment for local development. -->
    <!-- <script defer src="/__/firebase/5.7.1/firebase-app.js"></script> -->
    <!-- <script defer src="/__/firebase/5.7.1/firebase-firestore.js"></script> -->

    <!-- Uncomment for local development, comment for production. -->
    <script src="https://www.gstatic.com/firebasejs/5.7.1/firebase-app.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/5.7.1/firebase-firestore.js"></script> -->

    <!-- include only the Firebase features as you need -->
    <!-- <script defer src="/__/firebase/5.7.1/firebase-auth.js"></script> -->
    <!-- <script defer src="/__/firebase/5.7.1/firebase-messaging.js"></script> -->

    <!-- initialize the SDK after all desired features are loaded -->
    <!-- Uncomment for production, comment for local development. -->
    <!-- <script defer src="/__/firebase/init.js"></script> -->

    <link rel="stylesheet" href="style_main.css">
    <link rel="stylesheet" href="style_basic.css">
    <link rel="stylesheet" href="style_products.css">
    <link rel="stylesheet" href="style_info_modal.css">
</head>

<body>
    <div class="main">
        <div class="main__header">
            <h1 class="main__header__title"> Norwegian Kosher List </h1>
            <span id="info_modal__open" class="info_modal__open"></span>
        </div>

        <div id="searchBar" class="main__searchBar">
            <p class="main__searchBar__info">To search, write a text and press enter</p>
        </div>

        <div id="products" class="main__products"></div>

        <div class="main__footer">
        </div>
    </div>

    <div id="info_modal" class="info_modal">
        <div class="info_modal__content">

            <div class="info_modal__content__header">
                <div class="info_modal__close"></div>
                <span class="info_modal__content__header__logo"><img src="media/logo_vaadhakashrut.jpg" alt="" width="40%"></span>
                <span class="info_modal__content__header__logo"><img src="media/logo_dmt.png" alt="" width="40%"></span>
                <!-- <span class="info_modal__content__header__title">Kosher App</span> -->
            </div>

            <div class="info_modal__content__body">
                <h2>About</h2>
                <p class="info_modal__content__body__p">
                    Lorem ipsum dolor sit amet, justo ante. Lacinia dignissim, a faucibus. Ante litora tortor. Nisl
                    mauris leo, luctus ac semper. Sed quam vitae. Tellus pharetra in. Vel lobortis, dapibus arcu,
                    et
                    tortor. Nullam metus viverra, maecenas a purus. Pulvinar vitae.
                </p>

                <p class="info_modal__content__body__p">
                    In morbi, varius libero. Porta natoque, quisque ultrices parturient. Parturient duis accumsan,
                    curabitur vitae tempus, id adipiscing vel. Quis lectus. Dui elit, commodo rhoncus nec. In
                    etiam,
                    aliquam justo in, ultricies et quos. Eu nullam, eros aliquam, eu ipsum dictum.
                </p>

                <p class="info_modal__content__body__p">
                    In morbi, varius libero. Porta natoque, quisque ultrices parturient. Parturient duis accumsan,
                    curabitur vitae tempus, id adipiscing vel. Quis lectus. Dui elit, commodo rhoncus nec. In
                    etiam,
                    aliquam justo in, ultricies et quos. Eu nullam, eros aliquam, eu ipsum dictum.
                </p>

                <p class="info_modal__content__body__p">
                    In morbi, varius libero. Porta natoque, quisque ultrices parturient. Parturient duis accumsan,
                    curabitur vitae tempus, id adipiscing vel. Quis lectus. Dui elit, commodo rhoncus nec. In
                    etiam,
                    aliquam justo in, ultricies et quos. Eu nullam, eros aliquam, eu ipsum dictum.
                </p>

                <p class="info_modal__content__body__p">
                    Lorem ipsum dolor sit amet, justo ante. Lacinia dignissim, a faucibus. Ante litora tortor. Nisl
                    mauris leo, luctus ac semper. Sed quam vitae. Tellus pharetra in. Vel lobortis, dapibus arcu,
                    et
                    tortor. Nullam metus viverra, maecenas a purus. Pulvinar vitae.
                </p>

                <h2>Contact</h2>
                <p class="info_modal__content__body__p">
                    For questions or comments, please contact...
                    John Doe
                    johndoe@abc.abc
                </p>

                <h2>Tips</h2>
                <p class="info_modal__content__body__p">
                    <ul class="info_modal__content__body__ul">
                        <li class="info_modal__content__body__li">To see all the products id, add ?showids=1 to the end
                            of
                            the URL</li>
                        <li class="info_modal__content__body__li">To see a specific product - that you can share - add
                            ?id=123,
                            where 123 has to change to the id you want to see.</li>
                    </ul>
                </p>
            </div>

        </div>

    </div>

    <script type="module">
        import {data} from "./js_data.js";
        import * as view from "./js_mainView.js";
        import * as database from "./js_kappDb.js";
        import * as sw from "./js_serviceWorker.js";

        function getQueryData() {
            let kv;
            return location.search.slice(1).split("&").reduce((acc, curr) => {
                kv = curr.split("=");
                acc[kv[0]] = kv[1];
                return acc;
            }, {});
        }

        document.addEventListener('DOMContentLoaded', function () {
            sw.initServiceWorker()

            const query = getQueryData()

            console.log(data["metadata"]);
            console.log("query", query);

            const db = database.init(data);
            db.initLocalDb()
                .then((ready) => {
                    view.init(db, query.id, query.showids);
                });
        });

    </script>

</body>

</html>